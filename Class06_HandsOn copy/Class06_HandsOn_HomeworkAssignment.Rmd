---
title: "Class06_HandsOn"
author: "Analine Aguayo"
date: "10/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# Can you improve this analysis code?
library(bio3d)

s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug

s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s3, chain="A", elety="CA")

s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b

plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")

```

```{r}

```

```{r}
#make a plot with all three lines on it
plotb3(s3.b, typ="l", ylab="Bfactor",col="red")
points(s1.b, type="l",col="black")
points(s2.b, type="l", col="blue")
```


#Q6. How would you generalize the original code above to work with any set of input protein structures?
#Write your own function starting from the code above that analyzes protein drug interactions by reading in any protein PDB data and outputs a plot for the specified protein. (See class lecture 9 for further details).
#Submit by email to our class IA (see website for email address) your R markdown file (.Rmd) and either an HTML (.nb.html) or PDF (.pdf) file with the code and output saved.scoring rubric: Total 10 points assigned as follows:Documentation:1 pt - comments on what are the inputs to the function.1 pt - what the function does and how to use it.1 pt - what is the output of the function.Page 

```{r}


```

#Q6. How would you generalize the original code above to work with any set of input protein structures?

# library(bio3d) 
Define funtion that will call up your protein of interest's pdb

Protein_graph <- function(read.pdb(poi), poi.chainA <- trim.pdb(poi.a, chain="A", elety="CA", poi.chainA$atom$b, plotb3(poi.b, sse=s1.chainA, typ="l", ylab="Bfactor"))

```{r}
#Define the package needed for your code
library(bio3d)
#define the function where x is any protein of interest
protein_graph <- function(x) {
  #read.pdb downloads the protein of interest from the Protein Data Bank
  poi.x <- read.pdb(x)
  #trim.pdb "trims" your data pulled from PDB which contains a subset of atoms
  x.chainA <- trim.pdb(x, chain="A", elety="CA")
  x.b <- x.chainA$atom$b
  #plotb3 makes a scatter plot with optional secondary structure in the marginal regions. I removed the marginal regions.
  plotb3(x.b, typ="l", ylab="Bfactor", col = "blue")
}
              
x <- "4AKE"
#execute function
protein_graph(x)

```
```{r}
s1 <- read.pdb("4AKE") # kinase with drug
s2 <- read.pdb("1AKE") # kinase no drug
s3 <- read.pdb("1E4Y") # kinase with drug

s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s3, chain="A", elety="CA")

s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b

plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")


s1 <- read.pdb(poi)

```

```{r}
#Define the package needed for your code
library(bio3d)
#define the function where x is any protein of interest
Protein_graph <- function(x) {
  #read.pdb downloads the protein of interest from the Protein Data Bank
  x.a <- read.pdb(x)
  #trim.pdb "trims" your data pulled from PDB which contains a subset of atoms
  x.chainA <- trim.pdb(x.a, chain="A", elety="CA")
  x.b <- x.chainA$atom$b
  #plotb3 makes a scatter plot with optional secondary structure in the marginal regions. I removed the marginal regions.
  plotb3(x.b, typ="l", ylab="Bfactor", col = "blue")
}
              
x <- "4AKE"
#execute function
Protein_graph(x)
```

```{r}

#this will be my input that I will apply:
#pdbid <- "4AKE" (I can change this depending on the kinase)
#This function will make possible to visualize B factor trends for different proteins. 
z <- function(pdbid, chain="A") {
  s1 <- read.pdb(pdbid) # pdbid of any protein of interest; chain A is already defined
  s1.chainA <- trim.pdb(s1, chain=chain, elety="CA")
  s1.b <- s1.chainA$atom$b #defining atoms
  plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor") #plotting the results.
}

```


```{r} 
z("1AKE") #testing if the function works again with another kinase name
```


